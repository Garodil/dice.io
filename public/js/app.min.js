!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DemoApp=t():e.DemoApp=t()}(self,(()=>(()=>{"use strict";var e={919:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCookie=function(e){for(var t=e+"=",o=decodeURIComponent(document.cookie).split(";"),i=0;i<o.length;i++){for(var l=o[i];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(t))return l.substring(t.length,l.length)}return""},t.setCookie=function(e,t,o){var i=new Date;i.setTime(i.getTime()+24*o*60*60*1e3);var l="expires="+i.toUTCString();document.cookie=e+"="+t+";"+l+";path=/;samesite=strict"}},703:(e,t)=>{function o(e){return e+""}function i(e,t){return e.classList?e.classList.add(t):-1==e.className.split(" ").indexOf(t)&&(e.className+=" "+t),e}function l(e,t){return o(t).split(" ").forEach((t=>{e=i(e,t)})),e}function s(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return void 0===o?e.getAttribute(t):(null===o?e.setAttributeNode(document.createAttribute(t)):e.setAttribute(t,o),e)}Object.defineProperty(t,"__esModule",{value:!0}),t.addClass=l,t.addOneClass=i,t.attr=s,t.el=function(e){return document.querySelector(e)},t.make=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=document.createElement(e);t.class&&(o=l(o,t.class));t.text&&(o.innerText=t.text);if(t.attr&&"object"==typeof t.attr)for(var i in t.attr)s(o,i,t.attr[i]);t.html&&(o.innerHTML=t.html);return o},t.removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("\\b"+t+"\\b","g"),"");return e},t.str=o,t.toggleClass=function(e,t){if(e.classList)e.classList.toggle(t);else{var o=e.className.split(" "),i=o.indexOf(t);i>=0?o.splice(i,1):o.push(t),e.className=o.join(" ")}return e}},68:(e,t,o)=>{o.r(t)}},t={};function o(i){var l=t[i];if(void 0!==l)return l.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,o),s.exports}o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{var e=i;e.default=void 0,o(68);var t=o(703),l=o(919),s="__DiceIO_Demo_Nickname";e.default=class{constructor(e){this._diceRoller=e,this._setupApp(),this._setupNickname((()=>{this._setupDiceRoller()}))}get formula(){return(0,t.el)(".formula")}get rolls(){return(0,t.el)(".rolls")}get modal(){return(0,t.el)(".modal")}get modalNickname(){return(0,t.el)(".modal-nickname")}get modalButton(){return(0,t.el)(".modal-button")}get showModalButton(){return(0,t.el)(".topnav-nickname")}_setupApp(){this._IntlDateFormatter=new Intl.DateTimeFormat(void 0,{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),this.formula.addEventListener("keyup",(e=>{13===e.keyCode&&(e.preventDefault(),(0,t.str)(this.formula.value).length>1?this._diceRoller.roll(this.formula.value):this._inputErrorAnimation(this.formula))})),this.modalButton.addEventListener("click",(e=>{e.preventDefault(),(0,t.str)(this.modalNickname.value).length>1?(this._useNickname(this.modalNickname.value),this._setModalVisibility(!1)):this._inputErrorAnimation(this.modalNickname)})),this.showModalButton.addEventListener("click",(e=>{e.preventDefault(),this._setModalVisibility(!0)})),this._diceSound=new Audio("mp3/dice.mp3")}_setupNickname(e){var t=(0,l.getCookie)(s);if(t.length>1)return this._useNickname(t),this._setFocus(this.formula),e();this._setModalVisibility(!0),e()}_useNickname(e){(0,l.setCookie)(s,e,365),this.modalNickname.value=e,this.showModalButton.innerText=e,this._diceRoller.setNickname(e)}_setModalVisibility(e){e?(this.modalNickname.value=this._diceRoller.nickname,this.modal.style.display="block",this._setFocus(this.modalNickname)):(this.modal.style.display="none",this._setFocus(this.formula))}_setupDiceRoller(){this._diceRoller.onError((e=>{console.log("Dice roll error",e),this._inputErrorAnimation(this.formula)})).onDisconnect((e=>{console.log("Disconnected from "+e.serverUrl)})).onConnect((e=>{console.log("Connected to "+e.serverUrl)})).onHistory((e=>{this._onHistory(e)})).onRoll((e=>{this._onRoll(e)})).connect()}_onHistory(e){this._empty(this.rolls),e.forEach((e=>{this._appendRoll(e)})),this._scrollToBottom(document.body)}_onRoll(e){this._playRollSound(),this._appendRoll(e),this._scrollToBottom(document.body)}_playRollSound(){this._diceSound.load(),this._diceSound.play()}_empty(e){for(var t;t=e.lastChild;)e.removeChild(t)}_scrollToBottom(e){e.scrollTop=e.scrollHeight-e.clientHeight}_setFocus(e){setTimeout((()=>{e.focus()}),arguments.length>1&&void 0!==arguments[1]?arguments[1]:100)}_inputErrorAnimation(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input-error",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300;(0,t.addOneClass)(e,o),setTimeout((()=>{(0,t.removeClass)(e,o)}),i)}_formatTimestamp(e){return this._IntlDateFormatter.format(new Date(e))}_appendRoll(e){var o=(0,t.make)("div",{class:"roll"});o.appendChild((0,t.make)("div",{class:"roll-nickname",text:e.nickname})),o.appendChild((0,t.make)("div",{class:"roll-time",text:this._formatTimestamp(e.timestamp)})),o.appendChild((0,t.make)("div",{class:"roll-details",text:e.roll.message})),o.appendChild((0,t.make)("div",{class:"roll-result",text:e.roll.formula+" = "+e.roll.value})),this.rolls.appendChild(o)}}})(),i=i.default})()));